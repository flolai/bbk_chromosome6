                
#!/usr/bin/env python3

"""
Unit testing existing code

Original author: Oliver
Tested: Nini

2020

"""

#Unit testing dbapi functions

import unittest
from dbapi import dbapi



class TestGetEntries(unittest.TestCase):

    def setUp(self):
        """ The setUp method is called before any test method, e.g. gene_record1 is created as an instance here to be used as a mock entry.
        """
        self.gene_record1 = ({'gene_id': 'MICB01021', 'accession': 'AB003609', 'product': 'MICB', 'location': '6p21.3', 'cds': 'join(61..315587..8741037..13151415..1546', 'protein_seq': 'PHSLRYNLMVLSQDGSVQSGFLAEGHLDGQPFLRYDRQKRRAKPQGQWAEDVLGAKTWDTETEDLTENGQDLRRTLTHIKDQKGGLHSLQEIRVCEIHEDSSTRGSRHFYYDGELFLSQNLETQESTVPQSSRAQTLAMNVTNFWKEDAMKTKTHYRAMQADCLQKLQRYLKSGVAIRRTVPPMVNVTCSEVSEGNITVTCRASSFYPRNITLTWRQDGVSLSHNTQQWGDVLPDGNGTYQTWVATRIRQGEEQRFTCYMEHSGNHGTHPVPSGKALVLQSQRTDFPYVSAAMPCFVIIIILCVPCCKKKTSAAEGP', 'dna_seq': 'AAACATCAATGTGAAGTTATTTCCAGGAAGAAGTTTCACCTGTGATTTCCTCTTCCCCAGAGCCCCACAGTCTTCGTTACAACCTCATGGTGCTGTCCCAGGATGGATCTGTGCAGTCAGGGTTTCTCGCTGAGGGACATCTGGATGGTCAGCCCTTCCTGCGCTATGACAGGCAGAAACGCAGGGCAAAGCCCCAGGGACAGTGGGCAGAAGATGTCCTGGGAGCTAAGACCTGGGACACAGAGACCGAGGACTTGACAGAGAATGGGCAAGACCTCAGGAGGACCCTGACTCATATCAAGGACCAGAAAGGAGGTGAGAGTCGGCAGGGGCAAGAGTAATGGGAGGCCTTCTCCAGGAAAGTTGGAGACAGAGAGCAGGGACCTGTCTCTTCCCGCTGGATCTGGCTGGGGGTGGGGATGAGGAATAGGGTCAGGGAGGCTCAGCAGGGTGGTGAGCCGGAACTCAGCCCACACAGGGAGGCATGGAGGAGGGCCAGGGAGGGGTCGCCGCTGGGCTGAGTTCCTCACTTGGGTGGAAAGGTGATGGGTTCGGGAATGGAGAAGTCACTGCTGGGTGGGGGCAGGCTTGCATTCCCTCCAGGAGATTAGGGTCTGTGAGATCCATGAAGACAGCAGCACCAGGGGCTCCCGGCATTTCTACTACGATGGGGAGCTCTTCCTCTCCCAAAACCTGGAGACTCAAGAATCGACAGTGCCCCAGTCCTCCAGAGCTCAGACCTTGGCTATGAACGTCACAAATTTCTGGAAGGAAGATGCCATGAAGACCAAGACACACTATCGCGCTATGCAGGCAGACTGCCTGCAGAAACTACAGCGATATCTGAAATCCGGGGTGGCCATCAGGAGAACAGGTACCGACCCTGGCCACTTAGAGGGGAGCAGGGCTTCACTGGCTCTGCCCTTTCTTCTCCAGTGCCCCCCATGGTGAATGTCACCTGCAGCGAGGTCTCAGAGGGCAACATCACCGTGACATGCAGGGCTTCCAGCTTCTATCCCCGGAATATCACACTGACCTGGCGTCAGGATGGGGTATCTTTGAGCCACAACACCCAGCAGTGGGGGGATGTCCTGCCTGATGGGAATGGAACCTACCAGACCTGGGTGGCCACCAGGATTCGCCAAGGAGAGGAGCAGAGGTTCACCTGCTACATGGAACACAGCGGGAATCACGGCACTCACCCTGTGCCCTCTGGTGAGCCTGGGGTGACCCTGGAGAGGGTCAGGCCAGGTAGGAACAGCAGGGACGGCTGTGGCTTCTGCCCAGTGTATAACAAGTCCCTTTTTTTCAGGGAAGGCGCTGGTGCTTCAGAGTCAACGGACAGACTTTCCATATGTTTCTGCTGCTATGCCATGTTTTGTTATTATTATTATTCTCTGTGTCCCTTGTTGCAAGAAGAAAACATCAGCGGCAGAGGGTCCAGGTGAGAAAAGGGGACAGTTTCTGGAGA'})
        self.all_gene_records = ({'gene_id': 'HLA-DQA1', 'accession': 'AB006907', 'product': 'HMC class II surface glycoprotein', 'location': '6p21.3', 'cds': '1..82'})


    def tearDown(self):
        """ The tearDown method is executed after any test method and removes any newly created items so that the next function can be run independently from each other.
        """
        self.gene_record1.dispose()
        self.all_gene_records.dispose()

    def test_getEntry(self):
        """ To test the getEntry function, the expected output should be a list of dictionaries from a gene_record that is returned with the input of a GenBank accession number.
            ------------------------------
            Verification:
            NameError - 'config' is not defined in dbapi
        """
        self.assertRaises(Exception, e, "Exception occured:{}".format(e))
        self.assertEqual(self.gene_record1, dbapi.getEntry({'gene_id': 'MICB01021', 'accession': 'AB003609', 'product': 'MICB', 'location': '6p21.3', 'cds': 'join(61..315587..8741037..13151415..1546', 'protein_seq': 'PHSLRYNLMVLSQDGSVQSGFLAEGHLDGQPFLRYDRQKRRAKPQGQWAEDVLGAKTWDTETEDLTENGQDLRRTLTHIKDQKGGLHSLQEIRVCEIHEDSSTRGSRHFYYDGELFLSQNLETQESTVPQSSRAQTLAMNVTNFWKEDAMKTKTHYRAMQADCLQKLQRYLKSGVAIRRTVPPMVNVTCSEVSEGNITVTCRASSFYPRNITLTWRQDGVSLSHNTQQWGDVLPDGNGTYQTWVATRIRQGEEQRFTCYMEHSGNHGTHPVPSGKALVLQSQRTDFPYVSAAMPCFVIIIILCVPCCKKKTSAAEGP', 'dna_seq': 'AAACATCAATGTGAAGTTATTTCCAGGAAGAAGTTTCACCTGTGATTTCCTCTTCCCCAGAGCCCCACAGTCTTCGTTACAACCTCATGGTGCTGTCCCAGGATGGATCTGTGCAGTCAGGGTTTCTCGCTGAGGGACATCTGGATGGTCAGCCCTTCCTGCGCTATGACAGGCAGAAACGCAGGGCAAAGCCCCAGGGACAGTGGGCAGAAGATGTCCTGGGAGCTAAGACCTGGGACACAGAGACCGAGGACTTGACAGAGAATGGGCAAGACCTCAGGAGGACCCTGACTCATATCAAGGACCAGAAAGGAGGTGAGAGTCGGCAGGGGCAAGAGTAATGGGAGGCCTTCTCCAGGAAAGTTGGAGACAGAGAGCAGGGACCTGTCTCTTCCCGCTGGATCTGGCTGGGGGTGGGGATGAGGAATAGGGTCAGGGAGGCTCAGCAGGGTGGTGAGCCGGAACTCAGCCCACACAGGGAGGCATGGAGGAGGGCCAGGGAGGGGTCGCCGCTGGGCTGAGTTCCTCACTTGGGTGGAAAGGTGATGGGTTCGGGAATGGAGAAGTCACTGCTGGGTGGGGGCAGGCTTGCATTCCCTCCAGGAGATTAGGGTCTGTGAGATCCATGAAGACAGCAGCACCAGGGGCTCCCGGCATTTCTACTACGATGGGGAGCTCTTCCTCTCCCAAAACCTGGAGACTCAAGAATCGACAGTGCCCCAGTCCTCCAGAGCTCAGACCTTGGCTATGAACGTCACAAATTTCTGGAAGGAAGATGCCATGAAGACCAAGACACACTATCGCGCTATGCAGGCAGACTGCCTGCAGAAACTACAGCGATATCTGAAATCCGGGGTGGCCATCAGGAGAACAGGTACCGACCCTGGCCACTTAGAGGGGAGCAGGGCTTCACTGGCTCTGCCCTTTCTTCTCCAGTGCCCCCCATGGTGAATGTCACCTGCAGCGAGGTCTCAGAGGGCAACATCACCGTGACATGCAGGGCTTCCAGCTTCTATCCCCGGAATATCACACTGACCTGGCGTCAGGATGGGGTATCTTTGAGCCACAACACCCAGCAGTGGGGGGATGTCCTGCCTGATGGGAATGGAACCTACCAGACCTGGGTGGCCACCAGGATTCGCCAAGGAGAGGAGCAGAGGTTCACCTGCTACATGGAACACAGCGGGAATCACGGCACTCACCCTGTGCCCTCTGGTGAGCCTGGGGTGACCCTGGAGAGGGTCAGGCCAGGTAGGAACAGCAGGGACGGCTGTGGCTTCTGCCCAGTGTATAACAAGTCCCTTTTTTTCAGGGAAGGCGCTGGTGCTTCAGAGTCAACGGACAGACTTTCCATATGTTTCTGCTGCTATGCCATGTTTTGTTATTATTATTATTCTCTGTGTCCCTTGTTGCAAGAAGAAAACATCAGCGGCAGAGGGTCCAGGTGAGAAAAGGGGACAGTTTCTGGAGA'}))


    def test_get_allEntries(self,**kwargs):
        """ To test the getAllEntries function, the expected output should be a list of dictionaries of all gene_records.
            -------------------------------
            Verification:
            AttributeError - 'no attribute getAllEntries'
        """
        self.assertRaises(Exception, e, "Exception occured:{}".format(e))
	    self.assertEqual(self.all_gene_records, dbapi.getAllEntries(AB006907))




if __name__ == '__main__':
    unittest.main()

