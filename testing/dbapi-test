#!/usr/bin/env python3

"""
Unit testing existing code

Original author: Oliver
Tested: Nini

2020

"""

#Unit testing dbapi functions

import unittest


from dbapi import getEntry

class TestGetEntries(unittest.TestCase):

    def setUp(self, accession):
        """ The setUp method is called before any test method, e.g. gene_record1 is created as an instance here to be used as a mock entry.
        """
        self.gene_record1 = getEntry({'gene_id': 'MICB01021', 'accession': 'AB003609', 'product': 'MICB', 'location': '6p21.3', 'cds': 'join(61..315587..8741037..13151415..1546', 'protein_seq': 'PHSLRYNLMVLSQDGSVQSGFLAEGHLDGQPFLRYDRQKRRAKPQGQWAEDVLGAKTWDTETEDLTENGQDLRRTLTHIKDQKGGLHSLQEIRVCEIHEDSSTRGSRHFYYDGELFLSQNLETQESTVPQSSRAQTLAMNVTNFWKEDAMKTKTHYRAMQADCLQKLQRYLKSGVAIRRTVPPMVNVTCSEVSEGNITVTCRASSFYPRNITLTWRQDGVSLSHNTQQWGDVLPDGNGTYQTWVATRIRQGEEQRFTCYMEHSGNHGTHPVPSGKALVLQSQRTDFPYVSAAMPCFVIIIILCVPCCKKKTSAAEGP', 'dna_seq': 'AAACATCAATGTGAAGTTATTTCCAGGAAGAAGTTTCACCTGTGATTTCCTCTTCCCCAGAGCCCCACAGTCTTCGTTACAACCTCATGGTGCTGTCCCAGGATGGATCTGTGCAGTCAGGGTTTCTCGCTGAGGGACATCTGGATGGTCAGCCCTTCCTGCGCTATGACAGGCAGAAACGCAGGGCAAAGCCCCAGGGACAGTGGGCAGAAGATGTCCTGGGAGCTAAGACCTGGGACACAGAGACCGAGGACTTGACAGAGAATGGGCAAGACCTCAGGAGGACCCTGACTCATATCAAGGACCAGAAAGGAGGTGAGAGTCGGCAGGGGCAAGAGTAATGGGAGGCCTTCTCCAGGAAAGTTGGAGACAGAGAGCAGGGACCTGTCTCTTCCCGCTGGATCTGGCTGGGGGTGGGGATGAGGAATAGGGTCAGGGAGGCTCAGCAGGGTGGTGAGCCGGAACTCAGCCCACACAGGGAGGCATGGAGGAGGGCCAGGGAGGGGTCGCCGCTGGGCTGAGTTCCTCACTTGGGTGGAAAGGTGATGGGTTCGGGAATGGAGAAGTCACTGCTGGGTGGGGGCAGGCTTGCATTCCCTCCAGGAGATTAGGGTCTGTGAGATCCATGAAGACAGCAGCACCAGGGGCTCCCGGCATTTCTACTACGATGGGGAGCTCTTCCTCTCCCAAAACCTGGAGACTCAAGAATCGACAGTGCCCCAGTCCTCCAGAGCTCAGACCTTGGCTATGAACGTCACAAATTTCTGGAAGGAAGATGCCATGAAGACCAAGACACACTATCGCGCTATGCAGGCAGACTGCCTGCAGAAACTACAGCGATATCTGAAATCCGGGGTGGCCATCAGGAGAACAGGTACCGACCCTGGCCACTTAGAGGGGAGCAGGGCTTCACTGGCTCTGCCCTTTCTTCTCCAGTGCCCCCCATGGTGAATGTCACCTGCAGCGAGGTCTCAGAGGGCAACATCACCGTGACATGCAGGGCTTCCAGCTTCTATCCCCGGAATATCACACTGACCTGGCGTCAGGATGGGGTATCTTTGAGCCACAACACCCAGCAGTGGGGGGATGTCCTGCCTGATGGGAATGGAACCTACCAGACCTGGGTGGCCACCAGGATTCGCCAAGGAGAGGAGCAGAGGTTCACCTGCTACATGGAACACAGCGGGAATCACGGCACTCACCCTGTGCCCTCTGGTGAGCCTGGGGTGACCCTGGAGAGGGTCAGGCCAGGTAGGAACAGCAGGGACGGCTGTGGCTTCTGCCCAGTGTATAACAAGTCCCTTTTTTTCAGGGAAGGCGCTGGTGCTTCAGAGTCAACGGACAGACTTTCCATATGTTTCTGCTGCTATGCCATGTTTTGTTATTATTATTATTCTCTGTGTCCCTTGTTGCAAGAAGAAAACATCAGCGGCAGAGGGTCCAGGTGAGAAAAGGGGACAGTTTCTGGAGA'})
        self.gene_record2 = getEntry({'gene_id': 'gene_id2', 'accession': 'accession2', 'product': 'product2', 'location': 'location2', 'cds': 'cds2', 'protein_seq': 'protein_seq2', 'dna_seq': 'dna_seq2'})
        self.all_gene_records = getAllEntries({(gene_records)})

    def tearDown(self):
        """ The tearDown method is executed after any test method and removes any newly created items so that the next function can be run independently from each other.
        """
        try:
        self.gene_record1.remove()
        self.gene_record2.remove()
        
    
    def test_getEntry(self, accession):
        """ To test the getEntry function, the expected output should be an individual or list of dictionaries from a gene_record that is returned with the input of a GenBank accession number.
            ------------------------------
            Verification:
            Fail, 'invalid syntax on for statement in dbapi'
        """
        self.assertRaises(Exception, e, "Exception occured:{}".format(e))
        self.assertEqual(self.gene_record1, dbapi.getEntry({'gene_id': 'MICB01021', 'accession': 'AB003609', 'product': 'MICB', 'location': '6p21.3', 'cds': 'join(61..315587..8741037..13151415..1546', 'protein_seq': 'PHSLRYNLMVLSQDGSVQSGFLAEGHLDGQPFLRYDRQKRRAKPQGQWAEDVLGAKTWDTETEDLTENGQDLRRTLTHIKDQKGGLHSLQEIRVCEIHEDSSTRGSRHFYYDGELFLSQNLETQESTVPQSSRAQTLAMNVTNFWKEDAMKTKTHYRAMQADCLQKLQRYLKSGVAIRRTVPPMVNVTCSEVSEGNITVTCRASSFYPRNITLTWRQDGVSLSHNTQQWGDVLPDGNGTYQTWVATRIRQGEEQRFTCYMEHSGNHGTHPVPSGKALVLQSQRTDFPYVSAAMPCFVIIIILCVPCCKKKTSAAEGP', 'dna_seq': 'AAACATCAATGTGAAGTTATTTCCAGGAAGAAGTTTCACCTGTGATTTCCTCTTCCCCAGAGCCCCACAGTCTTCGTTACAACCTCATGGTGCTGTCCCAGGATGGATCTGTGCAGTCAGGGTTTCTCGCTGAGGGACATCTGGATGGTCAGCCCTTCCTGCGCTATGACAGGCAGAAACGCAGGGCAAAGCCCCAGGGACAGTGGGCAGAAGATGTCCTGGGAGCTAAGACCTGGGACACAGAGACCGAGGACTTGACAGAGAATGGGCAAGACCTCAGGAGGACCCTGACTCATATCAAGGACCAGAAAGGAGGTGAGAGTCGGCAGGGGCAAGAGTAATGGGAGGCCTTCTCCAGGAAAGTTGGAGACAGAGAGCAGGGACCTGTCTCTTCCCGCTGGATCTGGCTGGGGGTGGGGATGAGGAATAGGGTCAGGGAGGCTCAGCAGGGTGGTGAGCCGGAACTCAGCCCACACAGGGAGGCATGGAGGAGGGCCAGGGAGGGGTCGCCGCTGGGCTGAGTTCCTCACTTGGGTGGAAAGGTGATGGGTTCGGGAATGGAGAAGTCACTGCTGGGTGGGGGCAGGCTTGCATTCCCTCCAGGAGATTAGGGTCTGTGAGATCCATGAAGACAGCAGCACCAGGGGCTCCCGGCATTTCTACTACGATGGGGAGCTCTTCCTCTCCCAAAACCTGGAGACTCAAGAATCGACAGTGCCCCAGTCCTCCAGAGCTCAGACCTTGGCTATGAACGTCACAAATTTCTGGAAGGAAGATGCCATGAAGACCAAGACACACTATCGCGCTATGCAGGCAGACTGCCTGCAGAAACTACAGCGATATCTGAAATCCGGGGTGGCCATCAGGAGAACAGGTACCGACCCTGGCCACTTAGAGGGGAGCAGGGCTTCACTGGCTCTGCCCTTTCTTCTCCAGTGCCCCCCATGGTGAATGTCACCTGCAGCGAGGTCTCAGAGGGCAACATCACCGTGACATGCAGGGCTTCCAGCTTCTATCCCCGGAATATCACACTGACCTGGCGTCAGGATGGGGTATCTTTGAGCCACAACACCCAGCAGTGGGGGGATGTCCTGCCTGATGGGAATGGAACCTACCAGACCTGGGTGGCCACCAGGATTCGCCAAGGAGAGGAGCAGAGGTTCACCTGCTACATGGAACACAGCGGGAATCACGGCACTCACCCTGTGCCCTCTGGTGAGCCTGGGGTGACCCTGGAGAGGGTCAGGCCAGGTAGGAACAGCAGGGACGGCTGTGGCTTCTGCCCAGTGTATAACAAGTCCCTTTTTTTCAGGGAAGGCGCTGGTGCTTCAGAGTCAACGGACAGACTTTCCATATGTTTCTGCTGCTATGCCATGTTTTGTTATTATTATTATTCTCTGTGTCCCTTGTTGCAAGAAGAAAACATCAGCGGCAGAGGGTCCAGGTGAGAAAAGGGGACAGTTTCTGGAGA'}))


    def test_get_allEntries(self,**kwargs):
        """ To test the getAllEntries function, the expected output should be a list of dictionaries of all gene_records.
            -------------------------------
            Verification:
            Fail, 'invalid syntax on for statement in dbapi'
        """
        self.assertRaises(Exception, e, "Exception occured:{}".format(e))
        self.assertDictEqual(self.all_gene_records, dbapi.getAllEntries())



if __name__ == '__main__':
    unittest.main()
                                        
